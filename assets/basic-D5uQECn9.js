import"./modulepreload-polyfill-B5Qt9EMX.js";const m={tuesday:.1,bulk:.25,lucky:.2,suggestion:.05},E=.3,r=[{id:"p1",name:"상품1",price:1e4,quantity:50,discountRate:.1},{id:"p2",name:"상품2",price:2e4,quantity:30,discountRate:.15},{id:"p3",name:"상품3",price:3e4,quantity:20,discountRate:.2},{id:"p4",name:"상품4",price:15e3,quantity:0,discountRate:.05},{id:"p5",name:"상품5",price:25e3,quantity:10,discountRate:.25}],s={lastSelectedId:null,bonusPts:0,totalAmt:0,itemCnt:0},$=e=>t=>{const o=Math.random(0)*e;setTimeout(t,o)},x=(e,t)=>{const o=document.createElement(e);for(const[a,n]of Object.entries(t))o[a]=n;return o},M=e=>{const o=e.quantity>0?`재고 부족 (${e.quantity}개 남음)`:"품절";return`${e.name}: ${o}`},b=e=>{const t=e.textContent,[o,a]=t.split(" x ");return{name:o.trim(),quantity:parseInt(a.trim(),10)}},C=()=>{const e=document.getElementById("cart-total");s.bonusPts=Math.floor(s.totalAmt/1e3);let t=document.getElementById("loyalty-points");t||(t=x("span",{className:"text-blue-500 ml-2",id:"loyalty-points"}),e.appendChild(t)),t.textContent=`(포인트: ${s.bonusPts})`};function B(){const e=document.getElementById("stock-status"),t=r.filter(o=>o.quantity<5).map(M).join(`
`);e.textContent=t}function S(){const e=document.getElementById("cart-items"),t=document.getElementById("cart-total");s.totalAmt=0,s.itemCnt=0;const o=e.children;let a=0;for(let i=0;i<o.length;i++){const d=o[i],u=r.find(k=>k.id===d.id),y=d.querySelector("span"),{quantity:l}=b(y),g=u.price*l,v=l>=10?u.discountRate:0;s.itemCnt+=l,s.totalAmt+=g*(1-v),a+=g}let n=0;const p=s.totalAmt*m.bulk,c=a-s.totalAmt;if(s.itemCnt>=30&&p>c?(s.totalAmt=a*(1-m.bulk),n=m.bulk):n=c/a,new Date().getDay()===2&&(s.totalAmt*=1-m.tuesday,n=Math.max(n,m.tuesday)),t.textContent=`총액: ${Math.round(s.totalAmt)}원`,n>0){const i=x("span",{className:"text-red-500 ml-2",textContent:`(${(n*100).toFixed(1)}% 할인 적용)`});t.appendChild(i)}B(),C()}const f={template:()=>`<button id="add-to-cart" class="bg-blue-500 text-white px-4 py-2 rounded">
      추가
    </button>`,onMount:()=>{document.getElementById("add-to-cart").addEventListener("click",function(){const t=document.getElementById("product-select"),o=document.getElementById("cart-items"),a=t.value,n=r.find(c=>c.id===a);if(!n||n.quantity<=0)return;const p=document.getElementById(n.id);if(p){const c=p.querySelector("span"),{quantity:i}=b(c),d=i+1;if(d<=n.quantity){const u=`${n.name} - ${n.price}원 x ${d}`;c.textContent=u,n.quantity--}else alert("재고가 부족합니다.")}else{const c=x("div",{id:n.id,className:"flex justify-between items-center mb-2"}),i=`<button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${n.id}" data-change="-1">-</button>`,d=`<button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${n.id}" data-change="1">+</button>`,u=`<button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${n.id}">삭제</button>`,y=`<span>${n.name} - ${n.price}원 x 1</span>`;c.innerHTML=`${y}<div>${i}${d}${u}</div>`,o.appendChild(c),n.quantity--}S(),s.lastSelectedId=a})}},h={template:()=>'<div id="cart-items"></div>',onMount:()=>{document.getElementById("cart-items").addEventListener("click",function(t){const o=t.target,a=o.classList.contains("quantity-change"),n=o.classList.contains("remove-item");if(!a&&!n)return;const p=o.dataset.productId,c=document.getElementById(p),i=r.find(l=>l.id===p),d=c.querySelector("span"),{name:u,quantity:y}=b(d);if(a){const l=parseInt(o.dataset.change),g=y+l;g>0&&g<=i.quantity+y?(d.textContent=`${u} x ${g}`,i.quantity-=l):g<=0?(c.remove(),i.quantity-=l):alert("재고가 부족합니다.")}else n&&(i.quantity+=y,c.remove());S()})}},w={template:()=>'<select id="product-select" class="border rounded p-2 mr-2"></select>',onMount:()=>{}},A={template:()=>'<div id="stock-status" class="text-sm text-gray-500 mt-2 whitespace-pre-wrap"></div>',onMount:()=>{}},D={template:()=>`
    <h1 class="text-2xl font-bold mb-4">장바구니</h1>
  `,onMount:()=>{}},L={template:()=>'<div id="cart-total" class="text-lg font-bold my-4"></div> ',onMount:()=>{}};function q(){const e=document.getElementById("product-select");e.innerHTML="",r.forEach(t=>{const o=x("option",{value:t.id,textContent:`${t.name} - ${t.price}원`,disabled:t.quantity===0});e.appendChild(o)})}const I={template:()=>`
    <div class="bg-gray-100 p-8">
      <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8">
        ${D.template()}
        ${h.template()}
        ${L.template()}
        ${w.template()}
        ${f.template()}
        ${A.template()}
      </div>
    </div>
  `,onMount:()=>{var e,t;(e=h.onMount)==null||e.call(h),(t=f.onMount)==null||t.call(f),q(),S(),$(1e4)(()=>setInterval(R,3e4)),$(2e4)(()=>setInterval(T,6e4))}},R=()=>{const e=Math.floor(Math.random()*r.length),t=r[e],o=Math.random()<E,a=t.quantity>0;o&&a&&(alert(`번개세일! ${t.name}이(가) 20% 할인 중입니다!`),t.price=Math.round(t.price*(1-m.lucky)),q())},T=()=>{if(s.lastSelectedId){const e=r.find(t=>t.id!==s.lastSelectedId&&t.quantity>0);if(!e)return;alert(`${e.name}은(는) 어떠세요? 지금 구매하시면 ${m.suggestion*100}% 추가 할인!`),e.price=Math.round(e.price*(1-m.suggestion)),q()}};function P(){var t;const e=document.getElementById("app");e.innerHTML=I.template(),(t=I.onMount)==null||t.call(I)}P();
